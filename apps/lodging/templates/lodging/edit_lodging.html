
{% extends 'navbar.html' %}
{% load widget_tweaks %}
{% block title %}Update lodging{% endblock %}
{% load static %}

{% block head %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/zebra_datepicker/dist/css/bootstrap/zebra_datepicker.min.css">
    <link rel="stylesheet" href="{% static 'lodging/edit_lodging.css' %}">
    <link rel="stylesheet" href="{% static 'css/image-upload.css' %}">
{% endblock head %}
{% block script %}
    <script src="https://cdn.jsdelivr.net/npm/zebra_datepicker/dist/zebra_datepicker.min.js"></script>
    <script src="{% static 'lodging/edit_lodging.js' %}"></script>
    <script src="{% static 'js/image_field.js' %}"></script>
    <script src="{% static 'js/image-upload.js' %}"></script>
{% endblock script %}

{% block content %}
    <div class="container col-sm-10 col-md-9 col-lg-8 col-xl-7">
        <form action="{{ request.path }}" enctype="multipart/form-data" method="post" novalidate class="mt-5 custom-main-form">
            {% csrf_token %}
            <p class="h4 text-center custom-main-form-heading">
                <i class="fa fa-pencil"></i> Update lodging business</p>

            <input name="update" type="hidden" value="0">
            {% with WIDGET_ERROR_CLASS='invalid' WIDGET_REQUIRED_CLASS='required' %}

                <div class="form-row">
                    <div class="md-form col-12 col-sm-6">
                        <i class="fa fa-building prefix"></i>
                        {% render_field sublodging_form.total_floors|append_attr:"autofocus" class+="form-control" %}
                        <label for="id_total_floors">Total floors</label>
                        <div class="form-text">
                            <small class="text-muted">{{sublodging_form.total_floors.help_text}}</small>
                        </div>
                        {% if sublodging_form.total_floors.errors %}
                            <div class="error"><small>{{sublodging_form.total_floors.errors.0}}</small></div>
                        {% endif %}
                    </div>

                    <div class="md-form col-12 col-sm-6">
                        <i class="fa fa-building prefix"></i>
                        {% render_field sublodging_form.floor_no id="floor_no" class+="form-control" %}
                        <label for="floor_no">Floor number</label>
                        <small class="text-muted">{{sublodging_form.floor_no.help_text}}</small>
                        {% if sublodging_form.floor_no.errors %}
                            <div class="error"><small>{{sublodging_form.floor_no.errors.0}}</small></div>
                        {% endif %}
                    </div>

                    <div class="md-form col-12 col-sm-7">
                        <i class="fa fa-calendar prefix"></i>
                        {% render_field sublodging_form.available_from class+="form-control"%}
                        <label for="id_available_from">Available from</label>
                        <div id="datepicker-container"></div>
                        <div class="form-text">
                            <small class="text-muted">Date when lodging will be available for rent. Can be any future value.</small>
                        </div>
                        {% if sublodging_form.available_from.errors %}
                            <div class="error"><small>{{sublodging_form.available_from.errors.0}}</small></div>
                        {% endif %}
                    </div>

                    <div class="md-form col-12 col-sm-5">
                        <i class="fa fa-inr prefix"></i>
                        {% render_field sublodging_form.rent id="rent" class+="form-control" %}
                        <label for="rent">Rent</label>
                        {% if sublodging_form.rent.errors %}
                            <div class="error"><small>{{sublodging_form.rent.errors.0}}</small></div>
                        {% endif %}
                    </div>

                    <div class="md-form col-12">
                            <i class="fa fa-info-circle prefix"></i>
                        {% render_field sublodging_form.additional_details id="additional_details" class+="form-control md-textarea" %}
                        <label for="additional_details">Additional details</label>
                        <div class="form-text">
                            <small class="text-muted">{{sublodging_form.additional_details.help_text}}</small>
                        </div>
                        {% if sublodging_form.additional_details.errors %}
                            <div class="error"><small>{{sublodging_form.additional_details.errors.0}}</small></div>
                        {% endif %}
                    </div>

                    <div class="help-text text-muted mb-2 mt-4 col-12">
                            <small>Select those are available</small></div>
                    <div class="col-12 col-sm-4 mt-2">
                        {% render_field sublodging_form.is_furnished class+="option-input checkbox ml-0" %}
                        <label for="id_is_furnished" class="label align-top">
                            Furnished?
                        </label>
                        {% if sublodging_form.is_furnished.errors %}
                            <div class="error"><small>{{sublodging_form.is_furnished.errors.0}}</small></div>
                        {% endif %}
                    </div>
                    <div class="col-12 col-sm-4 mt-2">
                        {% render_field sublodging_form.is_parking_available class+="option-input checkbox" %}
                        <label for="id_is_parking_available" class="label align-top">
                            Parking available?
                        </label>
                        {% if sublodging_form.is_parking_available.errors %}
                            <div class="error"><small>{{sublodging_form.is_parking_available.errors.0}}</small></div>
                        {% endif %}
                    </div>
                    <div class="col-12 col-sm-4 mt-2">
                        {% render_field sublodging_form.is_kitchen_available class+="option-input checkbox" %}
                        <label for="id_is_kitchen_available" class="label align-top">
                            Kitchen available?
                        </label>
                        {% if sublodging_form.is_kitchen_available.errors %}
                            <div class="error"><small>{{sublodging_form.is_kitchen_available.errors.0}}</small></div>
                        {% endif %}
                    </div>
                </div>
                {% if images %}
                <div class="delete_images_container">
                    <h6 class="mt-3"><strong>Images</strong> (select to delete)</h6>
                    {% for image in images %}
                    <div class="md-form div-delete">
                        <div class="checkbox-container">
                            <input type="checkbox" name="delete_images" value="{{image.id}}" id="{{image.id}}" class="option-input checkbox">
                        </div>
                        <label for="{{image.id}}" class="label">
                            <img src={{image.image_thumbnail.url}}>
                        </label>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                <div style="clear:both"></div>
                <div id="uploaded_images_container">
                    <div><strong>Currently Uploaded Images</strong></div>
                </div>
                <div id="images_container">

                </div>
                <div style="clear:both"></div>
                <div class="form-row">
                    <div class="col-12">
                        <span class='btn btn-md btn-outline-primary ml-0 mt-3' id="add_image">
                            <i class="fa fa-file-image-o icon"></i> Add image</span>
                        {% if sublodging_form.errors %}
                            <div class="error"><small>{{sublodging_form.errors.0}}</small></div>
                        {% endif %}
                    </div>
                </div>
            {% endwith %}
            <div class="text-center mt-4">
                <button class="btn btn-primary btn-md" type="submit">
                    <i class="fa fa-edit icon"></i> Update</button>
                <a class="btn btn-danger btn-md" id="delete">
                    <i class="fa fa-remove icon"></i> Delete</a>
            </div>

            {{sublodging_form.images}}

        </form>
    </div>
    <script>
        var csrf_token="{{csrf_token}}";
    </script>
{% endblock %}